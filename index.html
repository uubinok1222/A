<!DOCTYPE html>
<html>
<head>
  <title>Tr√≤ ch∆°i ƒë√°nh d·∫•u bom 6x6</title>
  <style>
    table { border-collapse: collapse; margin: 10px auto; }
    td { width: 40px; height: 40px; border: 1px solid black; text-align: center; cursor: pointer; font-size: 16px; }
    .bomb { background: red; color: white; }
    .flag { background: yellow; }
    .revealed { background: lightgray; }
    #timer { text-align: center; font-size: 18px; margin-bottom: 10px; }
    #controls { text-align: center; margin-bottom: 10px; }
    button { padding: 10px; margin: 5px; font-size: 16px; }
  </style>
</head>
<body>
  <h2>ƒê√°nh d·∫•u bom 6x6</h2>
  <div id="timer">Th·ªùi gian: 2:00</div>
  <div id="controls">
    <button onclick="setMode('reveal')">N√∫t 1: M·ªü √¥</button>
    <button onclick="setMode('flag')">N√∫t 2: ƒê√°nh d·∫•u</button>
  </div>
  <table id="grid"></table>
  <script>
    const size = 6;
    const bombCount = 10;
    let bombs = [];
    let grid = Array(size).fill().map(() => Array(size).fill(false));
    let timeLeft = 120; // 2 ph√∫t
    let gameOver = false;
    let mode = 'reveal'; // Ch·∫ø ƒë·ªô m·∫∑c ƒë·ªãnh: m·ªü √¥

    // T·∫°o bom ng·∫´u nhi√™n
    while (bombs.length < bombCount) {
      let x = Math.floor(Math.random() * size);
      let y = Math.floor(Math.random() * size);
      if (!bombs.some(([bx, by]) => bx === x && by === y)) bombs.push([x, y]);
    }

    // T·∫°o l∆∞·ªõi
    let table = document.getElementById('grid');
    for (let i = 0; i < size; i++) {
      let row = table.insertRow();
      for (let j = 0; j < size; j++) {
        let cell = row.insertCell();
        cell.onclick = () => handleClick(i, j);
      }
    }

    // ƒê·∫øm ng∆∞·ª£c th·ªùi gian
    let timer = setInterval(() => {
      if (gameOver) return;
      timeLeft--;
      let minutes = Math.floor(timeLeft / 60);
      let seconds = timeLeft % 60;
      document.getElementById('timer').textContent = `Th·ªùi gian: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
      if (timeLeft <= 0) {
        gameOver = true;
        clearInterval(timer);
        alert('H·∫øt th·ªùi gian! Game Over!');
      }
    }, 1000);

    function setMode(newMode) {
      mode = newMode;
      document.getElementById('controls').children[0].style.background = mode === 'reveal' ? '#ddd' : '';
      document.getElementById('controls').children[1].style.background = mode === 'flag' ? '#ddd' : '';
    }

    function handleClick(i, j) {
      if (gameOver || grid[i][j]) return;
      let cell = table.rows[i].cells[j];
      if (mode === 'reveal') reveal(i, j);
      else flag(i, j);
    }

    function reveal(i, j) {
      let cell = table.rows[i].cells[j];
      if (cell.classList.contains('flag')) return;
      grid[i][j] = true;
      if (bombs.some(([x, y]) => x === i && y === j)) {
        cell.classList.add('bomb');
        cell.textContent = 'üí£';
        gameOver = true;
        clearInterval(timer);
        alert('Game Over! B·∫°n d√≠nh bom!');
      } else {
        cell.classList.add('revealed');
        let count = countNearbyBombs(i, j);
        if (count > 0) cell.textContent = count;
      }
    }

    function flag(i, j) {
      let cell = table.rows[i].cells[j];
      if (cell.classList.contains('revealed')) return;
      cell.classList.toggle('flag');
      cell.textContent = cell.classList.contains('flag') ? 'üö©' : '';
    }

    function countNearbyBombs(i, j) {
      let count = 0;
      for (let di = -1; di <= 1; di++) {
        for (let dj = -1; dj <= 1; dj++) {
          if (di === 0 && dj === 0) continue;
          let ni = i + di, nj = j + dj;
          if (ni >= 0 && ni < size && nj >= 0 && nj < size) {
            if (bombs.some(([x, y]) => x === ni && y === nj)) count++;
          }
        }
      }
      return count;
    }
  </script>
</body>
</html>
